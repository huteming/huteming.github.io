## Core Web Vitals

[web-vitals github](https://github.com/GoogleChrome/web-vitals)

![Core Web Vitals](/img/doc/core-web-vitals.png)

- `Largest Contentful Paint (LCP)`: 衡量加载体验：为了提供良好的用户体验， `LCP` 应该在页面首次开始加载后的 `2.5秒` 内发生。

- `First Input Delay (FID)`: 衡量可交互性，为了提供良好的用户体验，页面的 `FID` 应当小于 `100毫秒`。

- `Cumulative Layout Shift (CLS)`: 衡量视觉稳定性，为了提供良好的用户体验，页面的 `CLS` 应保持小于 `0.1`。

### LCP

`Largest Contentful Paint (LCP)` 用于衡量标准报告视口内可见的最大内容元素的渲染时间。为了提供良好的用户体验，网站应努力在开始加载页面的前 `2.5秒` 内进行最大内容渲染 。

相比 `FCP` ，这个指标就非常有价值了，因为这个值是根据页面加载渲染不断变化的，如果页面有一个 lodaing 动画，然后才渲染出具体内容，那么这个指标计算出来的就是具体内容的加载速度，而非 lodaing 动画的加载速度。

#### LCP 考虑哪些元素

`LCP` 目前并不会计算所有元素，因为这样会使这个指标变得非常复杂，它现在只关注下面的元素：

1. `<img>` 元素

2. `<image>` 元素内的`<svg>`元素

3. `<video>` 元素

4. 通过 `url()` 函数加载背景图片的元素

5. 包含文本节点或其他内联文本元素子级的块级元素。

### FID

`FID（ First Input Delay）` 即记录用户和页面进行首次交互操作所花费的时间 。`FID` 指标影响用户对页面交互性和响应性的第一印象。 为了提供良好的用户体验，站点应努力使首次输入延迟小于 `100毫秒`。

`FID` 发生在 `FCP` 和 `TTI` 之间，因为这个阶段虽然页面已经显示出部分内容，但尚不具备完全的可交互性。这个阶段用户和页面交互，往往会有较大延迟。

![FID](/img/doc/fid-task.png)

如上图所示，浏览器接收到用户输入操作时，主线程正在忙于执行一个耗时比较长的任务，只有当这个任务执行完成后，浏览器才能响应用户的输入操作。它必须等待的时间就此页面上该用户的 `FID` 值。

例如，以下所有 HTML 元素都需要在响应用户交互之前等待主线程上正在进行的任务完成：

1. 文本输入框，复选框和单选按钮（`<input>`，`<textarea>`）

2. 选择下拉菜单（`<select>`）

3. 链接（`<a>`）

### CLS

`CLS` 会测量在页面的整个生命周期中发生的每个意外的样式移动的所有单独布局更改得分的总和。布局的移动可能发生在可见元素从一帧到下一帧改变位置的任何时候。为了提供良好的用户体验，网站应努力使 `CLS` 分数小于 `0.1` 。

## 参考文章

[解读新一代 Web 性能体验和质量指标](https://juejin.cn/post/6844904168591736846)
