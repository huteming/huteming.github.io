## 何为前端路由？

路由（Router）这个概念最先是后端出现的，是用来跟后端服务器进行交互的一种方式，通过不同的路径，来请求不同的资源，请求不同的页面是路由的其中一种功能。

但是这有一个问题是，会造成页面的整体刷新。

前端随着 ajax 的流行，数据请求可以在不刷新浏览器的情况下进行。此时如果前端自己根据路由来刷新局部页面，页面跳转也能无需刷新页面，前端可以自主控制整个应用。

所以就有了前端路由。

## 前端 Router 基本功能

一个基本的前端路由至少应该提供以下功能：

1. 浏览器不会在 URL 发生改变时刷新整个页面。
2. 前端 Router 需要维护一个 URL 历史栈，通过这个栈可以返回之前页面，进入下一个页面。

目前 Router 有两种实现方式 History 和 hash。

## Hash 路由

URL Hash 的形式类似如下：

```js
// 表示文章列表页面
https://www.example.com/#/list

// 表示文章详情页面
https://www.example.com/#/detail
```

后面的内容即我们说的 hash 值。hash 用于表示页面的一个位置，当浏览器加载完页面后，会滚动到 hash 所指向的位置，这是 URL hash 最初的目的。

由于 hash 在浏览器中的特性，开发者们发现 hash 非常适合用来实现前端 Router。hash 具有实现前端 Router 的以下特点:

1. hash 只作用在浏览器，不会在请求中发送给服务器。
2. hash 发生变化时，浏览器并不会重新给后端发送请求加载页面。
3. 修改 hash 时会在浏览器留下历史记录，可以通过浏览器返回按钮回到上一个页面。
4. hash 发生变化时会触发 hashchange 事件，在该事件中可以通过 window.location.hash 获取到当前 hash 值。

## History 路由

History 在 H5 出现之前，可以使用 History.back() 向后跳转，使用 History.forward() 控制向前跳转。

可以根据 `popstate` 事件来监听 URL 的变化。

在 H5 中新增了 history.pushState() 和 history.replaceState()，分别可以添加和修改历史记录。

```js
window.history.pushState({}, 'title', 'https://www.limitcode.com/list')
window.history.replaceState({}, 'title', 'https://www.limitcode.com/detail')
```

`pushState()` 方法和 hash 一样，都不会触发页面刷新，只是导致 History 对象发生变化，地址栏会有反应。

注意，仅仅调用`pushState()`方法或`replaceState()`方法 ，并不会触发 `popstate`事件，只有用户点击浏览器倒退按钮和前进按钮，或者使用 JavaScript 调用 History.back()、History.forward()、History.go()方法时才会触发。另外，该事件只针对同一个文档，如果浏览历史的切换，导致加载不同的文档，该事件也不会触发。

## History 和 Hash 对比

1. hash 使用 # 后面的内容模拟一个完整路径，不太美观。
2. hash 在请求时不会发送给服务器，用户手动刷新页面，后端接受到了也是同一个地址。
3. History 直接修改浏览器 URL，用户手动刷新页面，后端接受到是不同的地址，需要后端做处理跳转到统一的 html 页面。
