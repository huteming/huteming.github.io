<!doctype html>
<html lang="zh-Hans" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="ç‰¹æ˜çš„æ—¥å¿— Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="ç‰¹æ˜çš„æ—¥å¿— Blog Atom Feed"><title data-react-helmet="true">axios æºç è§£æ | ç‰¹æ˜çš„æ—¥å¿—</title><meta data-react-helmet="true" property="og:title" content="axios æºç è§£æ | ç‰¹æ˜çš„æ—¥å¿—"><meta data-react-helmet="true" name="description" content="axios æºç ä¸­å‡ ä¸ªå…³é”®ç‚¹çš„è§£æã€‚ç‰ˆæœ¬å· v0.21.1"><meta data-react-helmet="true" property="og:description" content="axios æºç ä¸­å‡ ä¸ªå…³é”®ç‚¹çš„è§£æã€‚ç‰ˆæœ¬å· v0.21.1"><meta data-react-helmet="true" property="og:url" content="https://huteming.github.io/2021/08/23/axiosæºç è§£æ"><meta data-react-helmet="true" name="docusaurus_locale" content="zh-Hans"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://huteming.github.io/2021/08/23/axiosæºç è§£æ"><link data-react-helmet="true" rel="alternate" href="https://huteming.github.io/en/2021/08/23/axiosæºç è§£æ" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://huteming.github.io/2021/08/23/axiosæºç è§£æ" hreflang="zh-Hans"><link data-react-helmet="true" rel="alternate" href="https://huteming.github.io/2021/08/23/axiosæºç è§£æ" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.097ed6fd.css">
<link rel="preload" href="/assets/js/runtime~main.280bf283.js" as="script">
<link rel="preload" href="/assets/js/main.98b41e80.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">è·³åˆ°ä¸»è¦å†…å®¹</a></div><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"><b class="navbar__title">ç‰¹æ˜çš„æ—¥å¿—</b></a></div><div class="navbar__items navbar__items--right"><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><div class="sidebar_3-2F"><h3 class="sidebarItemTitle_10M-">All Blog Posts</h3><ul class="sidebarItemList_3L1d"><h4 class="sidebarItemTitle_10M-">2021</h4><li class="sidebarItem_3stU"><a aria-current="page" class="sidebarItemLink_3hZO sidebarItemLinkActive_1XEC" href="/2021/08/23/axiosæºç è§£æ">axios æºç è§£æ</a></li><li class="sidebarItem_3stU"><a class="sidebarItemLink_3hZO" href="/2021/08/20/æ–‡æœ¬æ¢è¡Œ">æ–‡æœ¬æ¢è¡Œ</a></li><li class="sidebarItem_3stU"><a class="sidebarItemLink_3hZO" href="/2021/08/09/æ­£åˆ™è¡¨è¾¾å¼">æ­£åˆ™è¡¨è¾¾å¼</a></li><li class="sidebarItem_3stU"><a class="sidebarItemLink_3hZO" href="/2021/07/16/React ç”Ÿå‘½å‘¨æœŸ">React ç”Ÿå‘½å‘¨æœŸ</a></li><li class="sidebarItem_3stU"><a class="sidebarItemLink_3hZO" href="/2021/07/15/typeofã€instanceofã€toStringåŒºåˆ«">typeofã€instanceofã€toStringåŒºåˆ«</a></li><li class="sidebarItem_3stU"><a class="sidebarItemLink_3hZO" href="/2021/07/14/cssè®¾ç½®å‚ç›´å±…ä¸­">cssè®¾ç½®å‚ç›´å±…ä¸­</a></li><li class="sidebarItem_3stU"><a class="sidebarItemLink_3hZO" href="/2021/07/13/cssåŠ è½½ä¼šé€ æˆé˜»å¡å—">cssåŠ è½½ä¼šé€ æˆé˜»å¡å—</a></li><li class="sidebarItem_3stU"><a class="sidebarItemLink_3hZO" href="/2021/07/12/prettier ä¸ eslint çš„é›†æˆ">prettier å’Œ eslint çš„é›†æˆ</a></li><li class="sidebarItem_3stU"><a class="sidebarItemLink_3hZO" href="/2021/07/09/script ä¸­çš„ async å’Œ defer å±æ€§">script æ ‡ç­¾çš„ async å’Œ defer å±æ€§</a></li></ul></div></aside><main class="col col--7"><article><header><h1 class="blogPostTitle_GeHD">axios æºç è§£æ</h1><div class="blogPostData_291c margin-vert--md"><time datetime="2021-08-23T00:00:00.000Z">August 23, 2021</time> Â· 6 åˆ†é’Ÿé˜…è¯»</div><div class="avatar margin-vert--md"><div class="avatar__intro"></div></div></header><div class="markdown"><p>axios æºç ä¸­å‡ ä¸ªå…³é”®ç‚¹çš„è§£æã€‚ç‰ˆæœ¬å· <code>v0.21.1</code></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="1-axios-ä¸ºä½•ä¼šæœ‰å¤šç§ä½¿ç”¨æ–¹å¼"></a>1 axios ä¸ºä½•ä¼šæœ‰å¤šç§ä½¿ç”¨æ–¹å¼<a class="hash-link" href="#1-axios-ä¸ºä½•ä¼šæœ‰å¤šç§ä½¿ç”¨æ–¹å¼" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="11-ä½¿ç”¨æ–¹å¼"></a>1.1 ä½¿ç”¨æ–¹å¼<a class="hash-link" href="#11-ä½¿ç”¨æ–¹å¼" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">#</a></h3><ol><li>ç¬¬ä¸€ç§ï¼Œç›´æ¥è°ƒç”¨</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">axios</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">axios</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><ol start="2"><li>ç¬¬äºŒç§ï¼Œå¿«æ·æ–¹å¼è°ƒç”¨</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><ol start="3"><li>ç¬¬ä¸‰ç§ï¼Œç”¨çš„ç›¸å¯¹ä¼šå°‘ä¸€äº›ï¼Œè°ƒç”¨ request æ–¹æ³•</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="12-æºä»£ç "></a>1.2 æºä»£ç <a class="hash-link" href="#12-æºä»£ç " title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">#</a></h3><blockquote><p>ä»£ç è·¯å¾„: <code>/lib/axios.js</code></p></blockquote><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createInstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">defaultConfig</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// åˆ›å»ºä¸€ä¸ª Axios å®ä¾‹å¯¹è±¡ã€‚</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// æ³¨æ„è¿™ä¸ªå®ä¾‹å¹¶ä¸æ˜¯æœ€åå¯¼å‡ºçš„ axios ï¼ï¼ï¼</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// è¿™ä¸ªå¯¹è±¡åªæ˜¯ç”¨ä½œç»‘å®š thisã€‚å„ä¸ªè¯·æ±‚ä¹‹é—´èƒ½å…±äº«å±æ€§ï¼ˆå¦‚ï¼šæ‹¦æˆªå™¨ï¼Œé…ç½®å‚æ•°ç­‰ï¼‰ä¹Ÿéƒ½æ˜¯å› ä¸ºæŒ‡å‘è¿™åŒä¸€ä¸ª this æ¥å®Œæˆçš„</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> context </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Axios</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">defaultConfig</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// æŠŠ Axios åŸå‹å¯¹è±¡ä¸Šçš„ request ç»‘å®š this åï¼Œä½œä¸ºæœ€ç»ˆè¿”å›çš„è¯·æ±‚æ–¹æ³•</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> instance </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">bind</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">prototype</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">request</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// å¤åˆ¶ Axios åŸå‹å¯¹è±¡ä¸Šçš„æ–¹æ³•ï¼ˆå¦‚ï¼šgetã€postã€deleteã€put ç­‰ç­‰ï¼‰ï¼Œå¹¶ç»‘å®š this</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">extend</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">instance</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">prototype</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// å¤åˆ¶ Axios å®ä¾‹å¯¹è±¡ä¸Šçš„å±æ€§ï¼ˆå¦‚ï¼šdefaultsã€interceptorsï¼‰ï¼Œå¹¶ç»‘å®š this</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">extend</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">instance</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// æœ€ç»ˆè¿”å›çš„æ˜¯ request å‡½æ•°</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// é€šè¿‡æŠŠå…¶ä»–è¯·æ±‚æ–¹æ³•å¤åˆ¶åˆ° request å‡½æ•°å¯¹è±¡ä¸Šï¼Œæ¥è¾¾åˆ°æœ€ç»ˆå¤šç§è°ƒç”¨æ–¹å¼çš„ç›®çš„</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> instance</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> axios </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createInstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">defaults</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>å¤§è‡´æµç¨‹: æ¯æ¬¡è°ƒç”¨ <code>createInstance</code> éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ä¸Šä¸‹æ–‡å®ä¾‹ï¼Œç„¶åæŠŠè¿™ä¸ªå®ä¾‹ç»‘å®šä¸º <code>request</code> çš„ <code>this</code>ï¼Œå†é€šè¿‡å¤åˆ¶çš„æ–¹å¼æŠŠå…¶ä»–çš„æ–¹æ³•ã€å±æ€§ç­‰ç­‰æŒ‚è½½åˆ°è¿™ä¸ª <code>request</code> ä¸Šã€‚æœ€åè¿”å›è¿™ä¸ªè¯·æ±‚å‡½æ•°å¯¹è±¡ <code>request</code>ã€‚</p><p>ç”¨ä¸€æ®µä¼ªä»£ç æ¥è¡¨ç¤ºæœ€ç»ˆæ•ˆæœï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// å®šä¹‰</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">axios</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">defaults</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">interceptors</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  request</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  response</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">get</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">post</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">request</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ä½¿ç”¨</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">axios</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="2-config-é…ç½®æ–¹å¼"></a>2 config é…ç½®æ–¹å¼<a class="hash-link" href="#2-config-é…ç½®æ–¹å¼" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">#</a></h2><p>ä»¥é…ç½® <code>baseURL</code>ã€<code>timeout</code> ä¸ºä¾‹æ¼”ç¤ºè¯´æ˜ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="21-axios-çš„é»˜è®¤é…ç½®"></a>2.1 axios çš„é»˜è®¤é…ç½®<a class="hash-link" href="#21-axios-çš„é»˜è®¤é…ç½®" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">#</a></h3><blockquote><p>ä»£ç è·¯å¾„ <code>/lib/axios.js</code></p></blockquote><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// /lib/defaults.js</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> defaults </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;./defaults&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> axios </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createInstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">defaults</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createInstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">defaultConfig</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> context </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Axios</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">defaultConfig</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><blockquote><p>ä»£ç è·¯å¾„ <code>/lib/core/Axios.js</code></p></blockquote><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Axios</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">instanceConfig</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">defaults</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> instanceConfig</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">interceptors</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    request</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">InterceptorManager</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    response</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">InterceptorManager</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>ä»¥ä¸Šæ˜¯å‡ ä¸ªç›¸å…³çš„ä»£ç ç‰‡æ®µã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼Œå¯¼å‡ºçš„ <code>axios</code> å…¶å®ä¹Ÿæ˜¯é€šè¿‡ <code>createInstance</code> ç”Ÿæˆçš„ï¼Œæ­¤æ—¶çš„é…ç½®å‚æ•°ä¸º <code>axios</code> çš„é»˜è®¤é…ç½®ã€‚</p><p>æœ€ç»ˆé…ç½®å¯¹è±¡éƒ½ä¼šè¢«ä¿å­˜åœ¨ <code>axios</code> ä¸Šçš„ <code>defaults</code> ä¸­ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="22-ç›´æ¥ä¿®æ”¹-axios-ä¸Šçš„å±æ€§"></a>2.2 ç›´æ¥ä¿®æ”¹ axios ä¸Šçš„å±æ€§<a class="hash-link" href="#22-ç›´æ¥ä¿®æ”¹-axios-ä¸Šçš„å±æ€§" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">#</a></h3><p><strong>ä½¿ç”¨æ–¹å¼</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">defaults</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;baseURL&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://somesite.com&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">defaults</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;timeout&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8000</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>åœ¨äº†è§£äº† <code>axios</code> è¿™ä¸ªå‡½æ•°å¯¹è±¡ä¸Šæœ‰ <code>defaults</code> è¿™ä¸ªå±æ€§åï¼Œè¿™ç§æ–¹å¼å°±å¾ˆå¥½ç†è§£äº†ï¼Œ</p><p>å°±æ˜¯ç›´æ¥ä¿®æ”¹ <code>axios</code> ä¸Šçš„ <code>defaults</code> å¯¹è±¡</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="23-åœ¨è¯·æ±‚çš„æ—¶å€™ç›´æ¥ä¼ é€’é…ç½®"></a>2.3 åœ¨è¯·æ±‚çš„æ—¶å€™ç›´æ¥ä¼ é€’é…ç½®<a class="hash-link" href="#23-åœ¨è¯·æ±‚çš„æ—¶å€™ç›´æ¥ä¼ é€’é…ç½®" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">#</a></h3><p><strong>ä½¿ç”¨æ–¹å¼</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  baseURL</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://somesite.com&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  timeout</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p><strong>æºä»£ç </strong></p><blockquote><p>ä»£ç è·¯å¾„ <code>/lib/core/Axios</code></p></blockquote><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">forEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;post&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;put&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;patch&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">forEachMethodWithData</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">method</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">Axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">prototype</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">method</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">url</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> data</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">mergeConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        method</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> method</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        url</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        data</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token class-name">Axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">prototype</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">request</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  config </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mergeConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">defaults</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>éœ€è¦å†æ¬¡å¼ºè°ƒçš„æ˜¯ï¼Œè™½ç„¶è¿™é‡Œçœ‹åˆ°çš„æ–¹æ³•éƒ½æ˜¯ <code>Axios</code> åŸå‹å¯¹è±¡ä¸Šçš„ï¼Œä½†æ˜¯å®é™…éƒ½æ˜¯åœ¨ <code>createInstance</code> ä¸­è¢«å¤åˆ¶åˆ°äº† <code>axios</code> è¿™ä¸ªå‡½æ•°å¯¹è±¡ä¸Šï¼Œå¹¶ä¸”ç»‘å®šäº† <code>this</code> ä¸º <code>axios</code>ã€‚</p><p>æ‰€ä»¥çœ‹åˆ°è¿™é‡Œï¼Œæ€è·¯ä¹Ÿå¾ˆæ¸…æ™°äº†ã€‚åœ¨ <code>post</code> ä¸­ï¼Œå®é™…å°±æ˜¯æŠŠè‡ªèº«å¿«æ·æ–¹å¼çš„ä¸€äº›å±æ€§é€šè¿‡ <code>mergeConfig</code> åˆå¹¶åˆ°ä¼ å…¥çš„é…ç½®å¯¹è±¡ <code>config</code> ä¸­ï¼Œç„¶åä¼ é€’æ‰§è¡ŒçœŸæ­£çš„è¯·æ±‚æ–¹æ³• <code>request</code>ã€‚</p><p><code>request</code> åˆä¼šæŠŠä¼ è¿›æ¥çš„ <code>config</code> å’Œ <code>defaults</code> è¿›è¡Œåˆå¹¶ï¼Œå¾—åˆ°æœ€ç»ˆçš„è¯·æ±‚é…ç½®</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="24-æ–°çš„è¯·æ±‚å®ä¾‹é‡æ–°é…ç½®"></a>2.4 æ–°çš„è¯·æ±‚å®ä¾‹é‡æ–°é…ç½®<a class="hash-link" href="#24-æ–°çš„è¯·æ±‚å®ä¾‹é‡æ–°é…ç½®" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">#</a></h3><p><strong>ä½¿ç”¨æ–¹å¼</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> instance </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">create</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  baseURL</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://somesite.com&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  timeout</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">instance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">defaults</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;baseURL&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://somesite.com&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">instance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">defaults</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;timeout&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">14000</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">instance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  baseURL</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://somesite.com&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  timeout</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">16000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p><strong>æºä»£ç </strong></p><p>å®ä¾‹ä¸Šä¿®æ”¹ <code>defaults</code> ä»¥åŠåœ¨ <code>post</code> ä¸­ä¼ å…¥è¯·æ±‚é…ç½®ï¼ŒåŸç†å’Œ <code>axios</code> æ˜¯ä¸€æ ·çš„ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚</p><p>å‰©ä¸‹å°±æ˜¯æ¥çœ‹ä¸‹ <code>axios.create</code> åšäº†ä»€ä¹ˆç‰¹åˆ«çš„äº‹æƒ…ã€‚</p><blockquote><p>ä»£ç è·¯å¾„ <code>/lib/axios</code></p></blockquote><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">create</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">create</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">instanceConfig</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createInstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">mergeConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">defaults</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> instanceConfig</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>è¿™é‡Œå°¤å…¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>create</code> çš„é…ç½®å‚æ•°ä¸æ˜¯ç›´æ¥ä¼ é€’ç»™ <code>createInstance</code>ï¼Œè€Œæ˜¯å…ˆå’Œ <code>axios.defaults</code> è¿›è¡Œäº†åˆå¹¶ï¼Œç„¶ååœ¨ä¼ é€’ä¸‹å»ä½¿ç”¨ã€‚</p><p>è¿™ä¹Ÿå°±æ„å‘³ç€ï¼Œé€šè¿‡ <code>axios.create</code> åˆ›å»ºçš„å®ä¾‹ï¼Œéƒ½æ˜¯ä¼šç»§æ‰¿ <code>axios.defaults</code> ä¸Šçš„é…ç½®ã€‚</p><p>æ‰€ä»¥åœ¨å¹³æ—¶å¼€å‘ä¸­ï¼Œé€šè¿‡ <code>axios.defaults</code> ç›´æ¥ä¿®æ”¹é…ç½®æ—¶ï¼Œéœ€è¦è°¨æ…åˆ¤æ–­ï¼Œè¿™ä¸ªå±æ€§æ˜¯å¦çœŸçš„æœ‰å¿…è¦è¢«é¡¹ç›®ä¸­å…¶ä»–å®ä¾‹ç»§æ‰¿</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="24-é…ç½®ä¼˜å…ˆçº§"></a>2.4 é…ç½®ä¼˜å…ˆçº§<a class="hash-link" href="#24-é…ç½®ä¼˜å…ˆçº§" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">#</a></h3><p>äº†è§£äº†å‡ ç§è¯·æ±‚é…ç½®çš„æ–¹å¼åï¼Œæœ€åæ¢³ç†ä¸‹å‡ ç§æ–¹å¼äº§ç”Ÿé…ç½®çš„ä¼˜å…ˆçº§ï¼Œåˆ†ä¸¤ç§æƒ…å†µï¼Œä¹Ÿå°±æ˜¯ <code>axios</code> ä»¥åŠ <code>axios å®ä¾‹</code></p><p><strong>axios ç›´æ¥è¯·æ±‚</strong></p><p>ä¼˜å…ˆçº§ä»é«˜åˆ°ä½ä¾æ¬¡ä¸º</p><ol><li><p>ä¸€äº›å¿«æ·æ–¹å¼ç‰¹å®šçš„é…ç½®ã€‚å¦‚ post è¯·æ±‚ï¼Œ{ method: &#x27;post&#x27; }</p></li><li><p>post optionsã€‚ä¸€æ¬¡æ€§çš„ï¼Œä¸ä¼šå½±å“åç»­è¯·æ±‚</p></li><li><p>axios ä¸Šçš„ defaults å±æ€§</p></li><li><p>å…¨å±€é»˜è®¤é…ç½®å¯¹è±¡ <code>/lib/defaults</code></p></li></ol><p><strong>axios å®ä¾‹ instance å‘èµ·çš„è¯·æ±‚</strong></p><p>ä¼˜å…ˆçº§ä»é«˜åˆ°ä½ä¾æ¬¡ä¸º</p><ol><li><p>ä¸€äº›å¿«æ·æ–¹å¼ç‰¹å®šçš„é…ç½®ã€‚å¦‚ post è¯·æ±‚ï¼Œ{ method: &#x27;post&#x27; }</p></li><li><p>post optionsã€‚ä¸€æ¬¡æ€§çš„ï¼Œä¸ä¼šå½±å“åç»­è¯·æ±‚</p></li><li><p>é€šè¿‡ axios.create ä¼ å…¥çš„é…ç½®</p></li><li><p>axios ä¸Šçš„ defaults å±æ€§</p></li><li><p>å…¨å±€é»˜è®¤é…ç½®å¯¹è±¡ <code>/lib/defaults</code></p></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="3-è¯·æ±‚åŠè¯·æ±‚æ‹¦æˆªå™¨çš„å·¥ä½œæµç¨‹"></a>3 è¯·æ±‚åŠè¯·æ±‚æ‹¦æˆªå™¨çš„å·¥ä½œæµç¨‹<a class="hash-link" href="#3-è¯·æ±‚åŠè¯·æ±‚æ‹¦æˆªå™¨çš„å·¥ä½œæµç¨‹" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">#</a></h2><blockquote><p>ä»£ç ç›®å½• <code>/lib/core/Axios</code></p></blockquote><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token class-name">Axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">prototype</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">request</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// åŒæ­¥è¿˜æ˜¯å¼‚æ­¥çš„æ–¹å¼æ‰§è¡Œæ‹¦æˆªå™¨ true: åŒæ­¥ï¼›falseï¼šå¼‚æ­¥</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// è¿™é‡Œé»˜è®¤è™½ç„¶æ˜¯åŒæ­¥çš„ï¼Œä½† request æ‹¦æˆªå™¨é»˜è®¤ä»¥å¼‚æ­¥çš„æ–¹å¼å¤„ç†ã€‚</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// æ·»åŠ  request æ‹¦æˆªå™¨ä¹‹åä¼šè¢«ä¿®æ”¹</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> synchronousRequestInterceptors </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// request æ‹¦æˆªå™¨æ•°ç»„ï¼Œå¶æ•°ä¸ªã€‚ fulfilledã€rejected ä¸€ç»„å¹³é“ºæ·»åŠ </span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> requestInterceptorChain </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">interceptors</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">request</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">forEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">unshiftRequestInterceptors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter">interceptor</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// synchronous é»˜è®¤æ˜¯ false, é»˜è®¤æ˜¯ç”¨å¼‚æ­¥çš„æ–¹å¼å¤„ç†</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    synchronousRequestInterceptors </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      synchronousRequestInterceptors </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> interceptor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">synchronous</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// æ³¨æ„ï¼Œè¿™é‡Œæ˜¯ä»¥æ·»åŠ  request æ‹¦æˆªå™¨çš„å€’åºæ‰§è¡Œ</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    requestInterceptorChain</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">unshift</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">interceptor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">fulfilled</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> interceptor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">rejected</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// response æ‹¦æˆªå™¨æ•°ç»„ï¼Œå¶æ•°ä¸ªã€‚ fulfilledã€rejected ä¸€ç»„å¹³é“ºæ·»åŠ </span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> responseInterceptorChain </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">interceptors</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">forEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">pushResponseInterceptors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter">interceptor</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    responseInterceptorChain</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">interceptor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">fulfilled</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> interceptor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">rejected</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> promise</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// å¼‚æ­¥çš„æ–¹å¼å¤„ç†æ‹¦æˆªå™¨</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">synchronousRequestInterceptors</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ä¿æŒ fulfilledã€rejected ä¸€ç»„çš„å½¢å¼ã€‚æ‰€ä»¥æ•°ç»„ç¬¬äºŒä¸ªæ˜¯ undefined</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// dispatchRequest å°±æ˜¯å‘èµ· XMLHttpRequest è¯·æ±‚çš„æ–¹æ³•</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> chain </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">dispatchRequest</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword nil" style="color:#00009f">undefined</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Array</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">prototype</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">unshift</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">chain</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> requestInterceptorChain</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    chain </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> chain</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">concat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">responseInterceptorChain</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// æŠŠ config ä»¥ Promise å½¢å¼åŒ…è£…</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    promise </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Promise</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">resolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">chain</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// å½¢æˆ promise å®Œæ•´é“¾æ¡</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      promise </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> promise</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">chain</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">shift</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> chain</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">shift</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> promise</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// åŒæ­¥çš„æ–¹å¼å¤„ç†æ‹¦æˆªå™¨</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>åœ¨ç§»é™¤ä¸€äº›å…¶ä»–åŠŸèƒ½ä»£ç åï¼Œå¯ä»¥æ¸…æ™°çš„çœ‹åˆ°ï¼Œæ•´ä¸ªè¿‡ç¨‹å…¶å®å°±æ˜¯ä¸€ä¸ª promise é“¾æ¡æ‰§è¡Œçš„è¿‡ç¨‹ã€‚</p><p>ç”¨ä¸€æ®µä¼ªä»£ç æ¥è¡¨ç¤ºæœ€ç»ˆæ•ˆæœ</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// æ‹¦æˆªå™¨é…ç½®</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">interceptors</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">request</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">use</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request11</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> request12</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">interceptors</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">request</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">use</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request21</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> request22</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">interceptors</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">use</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">response31</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> response32</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">interceptors</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">use</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">response41</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> response42</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// æœ€ç»ˆæ‰§è¡Œé¡ºåº</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token known-class-name class-name">Promise</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">resolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// request å€’åºæ‰§è¡Œ</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request21</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> request22</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request11</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> request12</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dispatchRequest</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// response é¡ºåºæ‰§è¡Œ</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">response31</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> response32</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">response41</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> response42</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="4-å¦‚ä½•å–æ¶ˆè¯·æ±‚"></a>4 å¦‚ä½•å–æ¶ˆè¯·æ±‚<a class="hash-link" href="#4-å¦‚ä½•å–æ¶ˆè¯·æ±‚" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">#</a></h2><p><strong>ä½¿ç”¨æ–¹å¼</strong></p><p>å®˜æ–¹ç»™å‡ºçš„ä½¿ç”¨æ–¹å¼</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">CancelToken</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">CancelToken</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> cancel</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/user/12345&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  cancelToken</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">CancelToken</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">executor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// An executor function receives a cancel function as a parameter</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    cancel </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> c</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// cancel the request</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cancel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>å®˜æ–¹è¿˜æœ‰å¦å¤–ä¸€ç§ä½¿ç”¨æ–¹å¼ã€‚ä½†ä¸‹é¢çœ‹è¿‡ä»£ç ä¹‹åå°±ä¼šå‘ç°ï¼Œ<code>CancelToken.source()</code> å…¶å®ä¹Ÿæ˜¯ <code>new CancelToken()</code> çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥ä¸‹é¢ä¸»è¦åˆ†æä¸Šé¢ä¸€ç§ä½¿ç”¨æ–¹å¼</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="41-canceltoken"></a>4.1 CancelToken<a class="hash-link" href="#41-canceltoken" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">#</a></h3><blockquote><p>ä»£ç è·¯å¾„ <code>/lib/cancel/CancelToken</code></p></blockquote><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">CancelToken</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">executor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> resolvePromise</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// åˆ›å»ºä¸€ä¸ª promiseï¼Œæ‹¿åˆ° resolve æ–¹æ³•</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">promise</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Promise</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">promiseExecutor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">resolve</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    resolvePromise </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> resolve</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> token </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// å°†å–æ¶ˆ cancel æ–¹æ³•ä½œä¸ºå‚æ•°ï¼Œä¼ å…¥å›è°ƒå‡½æ•°ï¼Œå¹¶ç«‹å³æ‰§è¡Œå›è°ƒå‡½æ•°</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">executor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">cancel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// é¿å…é‡å¤è°ƒç”¨</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">token</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">reason</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// cancel åªæ˜¯æŠŠ promise ç½®ä¸º resolve çŠ¶æ€</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    token</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">reason</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Cancel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">resolvePromise</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">token</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">reason</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">CancelToken</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">source</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">source</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> cancel</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> token </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">CancelToken</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">executor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    cancel </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> c</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    token</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> token</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    cancel</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> cancel</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p><code>CancelToken.source</code> å…¶å®ä¹Ÿæ˜¯å®ä¾‹åŒ– <code>CancelToken</code> çš„è¿‡ç¨‹ï¼Œç„¶åæŠŠå®ä¾‹ä¿¡æ¯è¿”å›ã€‚</p><p>ä¸»è¦çœ‹ <code>CancelToken</code> è¿™ä¸ªæ„é€ å‡½æ•°ã€‚å®ƒä¸»è¦åšäº†å‡ ä»¶äº‹ï¼š</p><ol><li><p>åˆ›å»ºæ–°çš„ Promiseï¼Œå¹¶æŠŠå®ƒæŒ‚åœ¨ <code>CancelToken</code> å®ä¾‹ä¸Šã€‚åŒæ—¶æ‹¿åˆ°è¿™ä¸ª Promise çš„ resolve æ–¹æ³•ã€‚</p></li><li><p>ç«‹å³æ‰§è¡Œä¼ å…¥çš„å›è°ƒå‡½æ•°ã€‚</p></li><li><p>å›è°ƒå‡½æ•°çš„å…¥å‚æ˜¯ä¸€ä¸ª cancel æ–¹æ³•ã€‚</p></li><li><p>cancel æ–¹æ³•å°±æ˜¯æ‰§è¡Œå®ä¾‹ä¸Š Promise çš„ resolve æ–¹æ³•çš„è¿‡ç¨‹ã€‚</p></li></ol><p>æ‰€ä»¥ <code>CancelToken</code> å¯ä»¥æ¦‚æ‹¬ä¸ºï¼š<strong>åˆ›å»ºä¸€ä¸ª Promiseï¼Œå¹¶é€šè¿‡ä¸€å®šæ‰‹æ®µï¼Œå¤–éƒ¨èƒ½æ‰‹åŠ¨æ§åˆ¶è¿™ä¸ª Promise çš„çŠ¶æ€</strong></p><p>è¿™æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ</p><p>ç»§ç»­çœ‹ä¸‹ä¸Šé¢è¯´çš„ <code>dispatchRequest</code>ï¼Œåœ¨å‘é€è¯·æ±‚æ—¶åšäº†ä»€ä¹ˆã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="42-dispatchrequest"></a>4.2 dispatchRequest<a class="hash-link" href="#42-dispatchrequest" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">#</a></h3><blockquote><p>ä»£ç è·¯å¾„ <code>/lib/cancel/CancelToken</code></p></blockquote><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token class-name">CancelToken</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">prototype</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">throwIfRequested</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">throwIfRequested</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">reason</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">reason</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><blockquote><p>ä»£ç è·¯å¾„ <code>/lib/core/dispatchRequest</code></p></blockquote><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// åˆ¤æ–­å¦‚æœè¯¥è¯·æ±‚è¢« cancel äº†, æŠ›å‡ºå¼‚å¸¸</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">throwIfCancellationRequested</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cancelToken</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cancelToken</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">throwIfRequested</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">dispatchRequest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">throwIfCancellationRequested</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// æ ¹æ®ç¯å¢ƒï¼Œå‘é€è¯·æ±‚ï¼Œå¹¶ Promise åŒ–</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// æµè§ˆå™¨ç¯å¢ƒä¸‹ï¼Œå°±æ˜¯åˆ©ç”¨ XMLHttpRequest</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> adapter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">adapter</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> defaults</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">adapter</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">adapter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">onAdapterResolution</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">response</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">throwIfCancellationRequested</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> response</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">onAdapterRejection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">reason</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token function" style="color:#d73a49">isCancel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">reason</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">throwIfCancellationRequested</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token known-class-name class-name">Promise</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">reject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">reason</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>dispatchRequest</code> ä¸»è¦åšäº†å‡ ä»¶äº‹ï¼š</p><ol><li><p>å‘é€è¯·æ±‚ä¹‹å‰ï¼Œåˆ¤æ–­è¯¥è¯·æ±‚æ˜¯å¦è¢«å–æ¶ˆ</p></li><li><p>å‘é€è¯·æ±‚</p></li><li><p>å‘é€è¯·æ±‚ä¹‹åï¼Œå†æ¬¡åˆ¤æ–­æ˜¯å¦è¢«å–æ¶ˆ</p></li></ol><p><code>dispatchRequest</code> å¯ä»¥æ¦‚æ‹¬ä¸ºï¼š<strong>å‘é€è¯·æ±‚ï¼ŒåŠå…¶æµç¨‹çŠ¶æ€åˆ¤æ–­</strong></p><p>æ¥ä¸‹æ¥çœ‹ä¸‹æµè§ˆå™¨ç¯å¢ƒä¸‹å‘é€è¯·æ±‚çš„æ–¹æ³•</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="43-xmlhttprequest"></a>4.3 XMLHttpRequest<a class="hash-link" href="#43-xmlhttprequest" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">#</a></h3><blockquote><p>ä»£ç è·¯å¾„ <code>/lib/adapters/xhr.js</code></p></blockquote><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">xhrAdapter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Promise</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">dispatchXhrRequest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">resolve</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> reject</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> request </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">XMLHttpRequest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    request</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">method</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">toUpperCase</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">buildURL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fullPath</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">params</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">paramsSerializer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cancelToken</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cancelToken</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">promise</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">onCanceled</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">cancel</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        request</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">abort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">reject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cancel</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        request </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    request</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">send</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">requestData</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>è¿™é‡Œæˆ‘ç§»é™¤äº†ä¸€äº›å’Œ <code>XMLHttpRequest</code> è¯·æ±‚å±æ€§ç›¸å…³çš„ä»£ç ï¼Œåªç•™ä¸‹äº†è¿™æ¬¡åˆ†æå…³æ³¨çš„ç‚¹ã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼Œé™¤äº† <code>request</code> æ­£å¸¸çš„å“åº”ä¹‹å¤–ï¼ŒåŒæ—¶è¿˜å¤šäº†ä¸€ä¸ªå’Œ <code>CancelToken</code> ç›¸å…³çš„çŠ¶æ€ã€‚</p><p>è¿™é‡Œçš„å¤„ç†æ–¹å¼å¾ˆç®€å•ï¼Œå°±æ˜¯åˆ¤æ–­ <code>config</code> ä¸­æ˜¯å¦æœ‰ <code>cancelToken</code> å®ä¾‹ï¼Œå¦‚æœæœ‰ï¼Œå°±åœ¨å®ä¾‹çš„ <code>promise</code> ä¸ŠæŒ‚ä¸€ä¸ª <code>then</code>ï¼Œ</p><p>åªè¦è¿™ä¸ª <code>promise</code> çŠ¶æ€æ”¹å˜ï¼Œå°±æŠŠè¿™æ¬¡è¯·æ±‚ <code>reject</code>ï¼Œç»“æŸè¯·æ±‚ï¼ŒæŠ›å‡ºå¼‚å¸¸ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="44-è¯·æ±‚å–æ¶ˆæµç¨‹æ¦‚æ‹¬"></a>4.4 è¯·æ±‚å–æ¶ˆæµç¨‹æ¦‚æ‹¬<a class="hash-link" href="#44-è¯·æ±‚å–æ¶ˆæµç¨‹æ¦‚æ‹¬" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">#</a></h3><p>ä»£ç æ˜¯çœ‹å®Œäº†ï¼Œå†æ¥ç”¨æ–‡å­—æè¿°ä¸‹è¿™ä¸ªè¿‡ç¨‹ã€‚</p><p>åœ¨å‘èµ· <code>http</code> è¯·æ±‚çš„åŒæ—¶ï¼Œå¢åŠ ä¸€ä¸ªç«äº‰æ€ Cancel Promiseï¼Œå½“å¤–ç•Œæ‰‹åŠ¨å–æ¶ˆæ—¶ï¼Œå°†è¿™ä¸ªç«äº‰æ€ç½®ä¸ºå·²å®Œæˆï¼Œç»“æŸè¿™æ¬¡ <code>http</code> è¯·æ±‚ã€‚</p><p>ç”¨ä¸€æ®µä¼ªä»£ç æ¥è¡¨ç¤ºæœ€ç»ˆæ•ˆæœ</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">dispatchRequest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token known-class-name class-name">Promise</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">race</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token maybe-class-name">XMLHttpRequestPromise</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token maybe-class-name">CancelPromise</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p><strong>ä¸ªäººçŒœæµ‹</strong></p><p>å› ä¸º Promise æ˜¯ä¸€ä¸ªå¾®ä»»åŠ¡ï¼Œä¸ºäº†é˜²æ­¢å› ä¸ºäº‹ä»¶å¾ªç¯çš„æœºåˆ¶å‡ºç°ä¸€äº›äº‰è®®ï¼Œ</p><p>(å¦‚ï¼šåœ¨è¯·æ±‚æ­£å¸¸å“åº”ä½†åç»­ then æ–¹æ³•æœªæ‰§è¡Œä¹‹å‰ï¼Œå¤–ç•Œæ‰§è¡Œäº† cancelï¼Œæ­¤æ—¶è¯¥æ€ä¹ˆç†è§£è¿™æ¬¡è¯·æ±‚çš„çŠ¶æ€ï¼Ÿ)ï¼Œ</p><p>æ‰€ä»¥ axios åœ¨å‘é€è¯·æ±‚ä¹‹å‰å’Œä¹‹åéƒ½æ·»åŠ äº† cancel çš„åˆ¤æ–­</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="5-è¶…æ—¶çš„å¤„ç†"></a>5 è¶…æ—¶çš„å¤„ç†<a class="hash-link" href="#5-è¶…æ—¶çš„å¤„ç†" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">#</a></h2><p><code>XMLHttpRequest</code> æœ¬èº«å°±èƒ½è®¾ç½®è¶…æ—¶ï¼Œæ‰€ä»¥åªéœ€è¦ç›‘å¬è¿™ä¸ªæ–¹æ³•æ¥ç»“æŸè¿™æ¬¡è¯·æ±‚</p><blockquote><p>ä»£ç è·¯å¾„ <code>/lib/adapters/xhr.js</code></p></blockquote><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">xhrAdapter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Promise</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">dispatchXhrRequest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">resolve</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> reject</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> request </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">XMLHttpRequest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    request</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">method</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">toUpperCase</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">buildURL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fullPath</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">params</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">paramsSerializer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    request</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">timeout</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">timeout</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    request</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">ontimeout</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">handleTimeout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> timeoutErrorMessage </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;timeout of &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">timeout</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ms exceeded&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">timeoutErrorMessage</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        timeoutErrorMessage </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">timeoutErrorMessage</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">reject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">createError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          timeoutErrorMessage</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          config</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">transitional</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">transitional</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">clarifyTimeoutError</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ETIMEDOUT&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ECONNABORTED&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          request</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// Clean up request</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      request </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Send the request</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    request</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">send</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">requestData</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="6-ä¼ªä»£ç æ¥ç†è§£æ•´ä¸ªè¿‡ç¨‹"></a>6 ä¼ªä»£ç æ¥ç†è§£æ•´ä¸ªè¿‡ç¨‹<a class="hash-link" href="#6-ä¼ªä»£ç æ¥ç†è§£æ•´ä¸ªè¿‡ç¨‹" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">axios</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token known-class-name class-name">Promise</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">resolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">requestHandler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dispatchRequest</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">responseHandler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">defaults</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">post</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">url</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> data</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">axios</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain">axios</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">defaults</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    method</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;post&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// prettier-ignore</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">dispatchRequest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token known-class-name class-name">Promise</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">race</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token maybe-class-name">XMLHttpRequestPromise</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token maybe-class-name">CancelPromise</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token maybe-class-name">TimeoutPromise</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_3kfx"><div class="col"><b>æ ‡ç­¾ï¼š</b><a class="margin-horiz--sm" href="/tags/http">http</a><a class="margin-horiz--sm" href="/tags/axios">axios</a></div><div class="col margin-top--sm"><a href="https://github.com/facebook/docusaurus/edit/master/website/blog/blog/2021-08-23-axiosæºç è§£æ.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>ç¼–è¾‘æ­¤é¡µ</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="åšæ–‡åˆ†é¡µå¯¼èˆª"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/2021/08/20/æ–‡æœ¬æ¢è¡Œ"><div class="pagination-nav__sublabel">è¾ƒæ—§ä¸€ç¯‡</div><div class="pagination-nav__label">æ–‡æœ¬æ¢è¡Œ Â»</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-axios-ä¸ºä½•ä¼šæœ‰å¤šç§ä½¿ç”¨æ–¹å¼" class="table-of-contents__link">1 axios ä¸ºä½•ä¼šæœ‰å¤šç§ä½¿ç”¨æ–¹å¼</a><ul><li><a href="#11-ä½¿ç”¨æ–¹å¼" class="table-of-contents__link">1.1 ä½¿ç”¨æ–¹å¼</a></li><li><a href="#12-æºä»£ç " class="table-of-contents__link">1.2 æºä»£ç </a></li></ul></li><li><a href="#2-config-é…ç½®æ–¹å¼" class="table-of-contents__link">2 config é…ç½®æ–¹å¼</a><ul><li><a href="#21-axios-çš„é»˜è®¤é…ç½®" class="table-of-contents__link">2.1 axios çš„é»˜è®¤é…ç½®</a></li><li><a href="#22-ç›´æ¥ä¿®æ”¹-axios-ä¸Šçš„å±æ€§" class="table-of-contents__link">2.2 ç›´æ¥ä¿®æ”¹ axios ä¸Šçš„å±æ€§</a></li><li><a href="#23-åœ¨è¯·æ±‚çš„æ—¶å€™ç›´æ¥ä¼ é€’é…ç½®" class="table-of-contents__link">2.3 åœ¨è¯·æ±‚çš„æ—¶å€™ç›´æ¥ä¼ é€’é…ç½®</a></li><li><a href="#24-æ–°çš„è¯·æ±‚å®ä¾‹é‡æ–°é…ç½®" class="table-of-contents__link">2.4 æ–°çš„è¯·æ±‚å®ä¾‹é‡æ–°é…ç½®</a></li><li><a href="#24-é…ç½®ä¼˜å…ˆçº§" class="table-of-contents__link">2.4 é…ç½®ä¼˜å…ˆçº§</a></li></ul></li><li><a href="#3-è¯·æ±‚åŠè¯·æ±‚æ‹¦æˆªå™¨çš„å·¥ä½œæµç¨‹" class="table-of-contents__link">3 è¯·æ±‚åŠè¯·æ±‚æ‹¦æˆªå™¨çš„å·¥ä½œæµç¨‹</a></li><li><a href="#4-å¦‚ä½•å–æ¶ˆè¯·æ±‚" class="table-of-contents__link">4 å¦‚ä½•å–æ¶ˆè¯·æ±‚</a><ul><li><a href="#41-canceltoken" class="table-of-contents__link">4.1 CancelToken</a></li><li><a href="#42-dispatchrequest" class="table-of-contents__link">4.2 dispatchRequest</a></li><li><a href="#43-xmlhttprequest" class="table-of-contents__link">4.3 XMLHttpRequest</a></li><li><a href="#44-è¯·æ±‚å–æ¶ˆæµç¨‹æ¦‚æ‹¬" class="table-of-contents__link">4.4 è¯·æ±‚å–æ¶ˆæµç¨‹æ¦‚æ‹¬</a></li></ul></li><li><a href="#5-è¶…æ—¶çš„å¤„ç†" class="table-of-contents__link">5 è¶…æ—¶çš„å¤„ç†</a></li><li><a href="#6-ä¼ªä»£ç æ¥ç†è§£æ•´ä¸ªè¿‡ç¨‹" class="table-of-contents__link">6 ä¼ªä»£ç æ¥ç†è§£æ•´ä¸ªè¿‡ç¨‹</a></li></ul></div></div></div></div></div></div>
<script src="/assets/js/runtime~main.280bf283.js"></script>
<script src="/assets/js/main.98b41e80.js"></script>
</body>
</html>